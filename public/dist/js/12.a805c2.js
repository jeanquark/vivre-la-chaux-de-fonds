(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{106:function(t,e,n){"use strict";n.r(e);var o=n(0),a=n.n(o),r=n(5),i=n.n(r),s=n(11),c=n.n(s),l=n(16),u=n(15),d=n(58),m=n(18);function f(t,e,n,o,a,r,i){try{var s=t[r](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(o,a)}function p(t){return function(){var e=this,n=arguments;return new Promise(function(o,a){var r=t.apply(e,n);function i(t){f(r,o,a,i,s,"next",t)}function s(t){f(r,o,a,i,s,"throw",t)}i(void 0)})}}var h={components:{Multiselect:c.a,ImagesModal:l.a,DocumentsModal:u.a,CreateLinkModal:d.a,ImageProperties:m.a},created:function(){var t=p(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),mounted:function(){var t=p(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(Object.keys(this.$store.getters["sections/sections"]).length<2)){t.next=3;break}return t.next=3,this.$store.dispatch("sections/fetchSections");case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),data:function(){return{form:new i.a({name:"",content:""}),showHTML:!1,content:'<img src="/images/favicon.png" style="margin-right: 20px;" />',checked:!1,showImagesModal:!1,showDocumentsModal:!1,selectedImageNode:null,showCreateLinkModal:!1,selectedImageProps:{width:0,height:0,style:{}},focused:!1,pageSections:[]}},computed:{loading:function(){return this.$store.getters["loading/loading"]},sections:function(){return this.$store.getters["sections/sections"]},sectionsArray:function(){var t=this,e=[];return Object.keys(this.sections).forEach(function(n){return e.push(t.sections[n])}),e}},methods:{toggleShowHTML:function(){this.showHTML?this.content=document.getElementById("textBox").innerText:this.content=document.getElementById("textBox").innerHTML,this.showHTML=!this.showHTML},updateSelectedImage:function(t,e){console.log("updateSelectedImage: ",t,e),"width"!==e&&"height"!==e||(this.selectedImageNode[e]=t),"margin"===e&&(this.selectedImageNode.style.margin="".concat(t,"px")),"marginRight"===e&&(this.selectedImageNode.style.marginRight="".concat(t,"px")),"float"===e&&(this.selectedImageNode.style.float=t)},selectElement:function(t){this.selectedImageNode=null,console.log("selectElement: ",t);var e=t.target.tagName.toLowerCase();console.log("element: ",e),"img"===e&&(console.log("img!"),this.selectedImageNode=t.target,this.selectedImageProps.width=t.target.width,this.selectedImageProps.height=t.target.height,this.selectedImageProps.style["margin-left"]=t.target.style["margin-left"]?t.target.style["margin-left"].match(/\d/g).join(""):0,this.selectedImageProps.style["margin-right"]=t.target.style["margin-right"]?t.target.style["margin-right"].match(/\d/g).join(""):0,this.selectedImageProps.style.float=t.target.style.float)},updateSelectedImageProperties:function(t,e){console.log("updateSelectedImageProperties2: ",t,e),console.log("selectedImageNode: ",this.selectedImageNode),"width"!==e&&"height"!==e||(this.selectedImageNode[e]=t),"marginLeft"===e&&(this.selectedImageNode.style.marginLeft="".concat(t,"px")),"marginRight"===e&&(this.selectedImageNode.style.marginRight="".concat(t,"px")),"float"===e&&(this.selectedImageNode.style.float=t)},openImagesModal:function(){var t=this;console.log("openImagesModal"),this.showImagesModal=!0,setTimeout(function(){t.$bvModal.show("imagesModal")},300)},openDocumentsModal:function(){var t=this;console.log("openDocumentsModal"),this.showDocumentsModal=!0,setTimeout(function(){t.$bvModal.show("documentsModal")},300)},openCreateLinkModal:function(){var t=this;console.log("openCreateLinkModal"),this.showCreateLinkModal=!0,setTimeout(function(){t.$bvModal.show("createLinkModal")},300)},insertImage:function(t){console.log("insertImage2: ",t),this.showModal=!1;var e="/images/".concat(t);this.formatDoc("insertImage",e)},insertDocument:function(t,e,n){console.log("insertDocument",t,e,n),this.formatDoc("insertHTML",'<a href="/documents/'.concat(t,'" type="').concat(e,'" title="').concat(n,'" target="_blank">').concat(n,"</a>"))},insertLink:function(t){console.log("insertLink: ",t),this.formatDoc("createLink",t)},insertDiv:function(t){document.execCommand("formatBlock",!1,"div"),window.getSelection().focusNode.parentNode.className="col-6"},formatDoc:function(t,e){document.execCommand(t,!1,e)},createNewPage:function(){var t=p(a.a.mark(function t(){var e;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log("createNewPage"),this.$store.commit("loading/SET_LOADING",!0),e=this.showHTML?document.getElementById("textBox").innerText:document.getElementById("textBox").innerHTML,this.form.content=e,console.log("this.form: ",this.form),t.next=8,this.$store.dispatch("pages/createPage",this.form);case 8:this.$store.commit("loading/SET_LOADING",!1),this.$noty.success("Nouvelle page créée avec succès!"),this.$router.push("/admin/pages"),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(0),this.$store.commit("loading/SET_LOADING",!1),this.$noty.error("Une erreur est survenue et la nouvelle page n'a pas pu être créée.");case 17:case"end":return t.stop()}},t,this,[[0,13]])}));return function(){return t.apply(this,arguments)}}()}},g=(n(280),n(2)),v=Object(g.a)(h,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-container",[n("b-breadcrumb",[n("b-breadcrumb-item",{staticClass:"navigation",attrs:{to:"/admin/pages"}},[n("font-awesome-icon",{attrs:{icon:"folder"}}),t._v(" "),n("span",[t._v("Pages")])],1),t._v(" "),n("b-breadcrumb-item",{attrs:{active:""}},[t._v("Créer")])],1),t._v(" "),n("h2",{staticClass:"text-center"},[t._v("Créer une nouvelle page")]),t._v(" "),n("b-form",{on:{submit:function(e){return e.preventDefault(),t.createNewPage(e)}}},[n("b-row",{staticClass:"justify-content-start my-3 px-3",attrs:{"align-v":"center"}},[n("b-col",{attrs:{cols:"12"}},[n("b-form-group",{attrs:{label:"Titre:","label-for":"name"}},[n("b-form-input",{class:{"is-invalid":t.form.errors.has("name")},attrs:{id:"name",name:"name",placeholder:"Titre de la page"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}}),t._v(" "),n("has-error",{attrs:{form:t.form,field:"name"}})],1)],1),t._v(" "),n("b-col",{staticClass:"my-2",attrs:{cols:"12"}},[n("b-form-group",{attrs:{label:"Sections:"}},[n("multiselect",{attrs:{"tag-placeholder":"Add this as new tag",placeholder:"Search or add a tag",label:"name","track-by":"id",options:t.sectionsArray,multiple:!0,taggable:!0},model:{value:t.pageSections,callback:function(e){t.pageSections=e},expression:"pageSections"}})],1)],1),t._v(" "),n("b-col",{attrs:{cols:"12"}},[n("b-form-group",{attrs:{label:"Contenu de la page:","label-for":"newPageContent"}},[n("b-row",{staticClass:"justify-content-start",attrs:{"no-gutters":""}},[n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"mx-1",attrs:{variant:"primary",title:"Gras"},on:{click:function(e){return e.preventDefault(),t.formatDoc("bold")}}},[n("font-awesome-icon",{attrs:{size:"1x",icon:"bold"}})],1),t._v(" "),n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"mx-1",attrs:{variant:"primary",title:"Italic"},on:{click:function(e){return e.preventDefault(),t.formatDoc("italic")}}},[n("font-awesome-icon",{attrs:{size:"1x",icon:"italic"}})],1),t._v(" "),n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"mx-1",attrs:{variant:"primary",title:"Souligné"},on:{click:function(e){return e.preventDefault(),t.formatDoc("underline")}}},[n("font-awesome-icon",{attrs:{size:"1x",icon:"underline"}})],1),t._v(" "),n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"mx-1",attrs:{variant:"primary",title:"Aligner à gauche"},on:{click:function(e){return e.preventDefault(),t.formatDoc("justifyleft")}}},[n("font-awesome-icon",{attrs:{size:"1x",icon:"align-left"}})],1),t._v(" "),n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"mx-1",attrs:{variant:"primary",title:"Aligner au centre"},on:{click:function(e){return e.preventDefault(),t.formatDoc("justifycenter")}}},[n("font-awesome-icon",{attrs:{size:"1x",icon:"align-center"}})],1),t._v(" "),n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"mx-1",attrs:{variant:"primary",title:"Aligner à droite"},on:{click:function(e){return e.preventDefault(),t.formatDoc("justifyright")}}},[n("font-awesome-icon",{attrs:{size:"1x",icon:"align-right"}})],1),t._v(" "),n("b-button",{staticClass:"mx-1",attrs:{variant:"primary",title:"Liste point"},on:{click:function(e){return e.preventDefault(),t.formatDoc("insertUnorderedList")}}},[n("font-awesome-icon",{attrs:{size:"1x",icon:"list-ul"}})],1),t._v(" "),n("b-button",{staticClass:"mx-1",attrs:{variant:"primary",title:"Liste nombre"},on:{click:function(e){return e.preventDefault(),t.formatDoc("insertOrderedList")}}},[n("font-awesome-icon",{attrs:{size:"1x",icon:"list-ol"}})],1),t._v(" "),n("b-button",{staticClass:"mx-1",attrs:{variant:"primary",title:"Lien"},on:{click:function(e){return e.preventDefault(),t.openCreateLinkModal(e)}}},[n("font-awesome-icon",{attrs:{size:"1x",icon:"link"}})],1),t._v(" "),n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"mx-1",attrs:{variant:"secondary",title:"Ajouter image",disabled:!t.focused},on:{mousedown:function(e){e.preventDefault(),t.focused=!0},click:function(e){return e.preventDefault(),t.openImagesModal(e)}}},[n("font-awesome-icon",{attrs:{size:"1x",icon:"image"}})],1),t._v(" "),n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"mx-1",attrs:{variant:"secondary",title:"Ajouter PDF",disabled:!t.focused},on:{mousedown:function(e){e.preventDefault(),t.focused=!0},click:function(e){return e.preventDefault(),t.openDocumentsModal(e)}}},[n("font-awesome-icon",{attrs:{size:"1x",icon:"file-pdf"}})],1),t._v(" "),n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"mx-1",attrs:{variant:"dark",title:"Voir code"},on:{click:t.toggleShowHTML}},[n("font-awesome-icon",{attrs:{size:"1x",icon:"code"}})],1),t._v(" "),n("button",{on:{click:function(e){return e.preventDefault(),t.insertDiv("12")}}},[t._v("Insert div")])],1),t._v(" "),t.selectedImageNode?n("b-row",{staticClass:"justify-content-center my-2",attrs:{"no-gutters":""}},[n("b-col",{attrs:{cols:"12"}},[n("image-properties",{attrs:{selectedImageProps:t.selectedImageProps},on:{updateSelectedImageProperties:t.updateSelectedImageProperties}})],1)],1):t._e(),t._v(" "),t.showHTML?n("div",{staticClass:"mt-1",attrs:{contenteditable:"true",id:"textBox"},on:{focus:function(e){t.focused=!0},blur:function(e){t.focused=!1}}},[n("pre",{},[t._v(t._s(t.content))])]):n("div",{staticClass:"mt-1",attrs:{contenteditable:"true",id:"textBox"},domProps:{innerHTML:t._s(t.content)},on:{focus:function(e){t.focused=!0},blur:function(e){t.focused=!1},click:t.selectElement}})],1)],1)],1),t._v(" "),n("b-row",{staticClass:"justify-content-center my-2"},[n("b-button",{attrs:{variant:"primary",disabled:t.loading,type:"submit"}},[t.loading?n("b-spinner",{attrs:{small:"",type:"grow"}}):t._e(),t._v("\n                Créer nouvelle page\n            ")],1)],1)],1),t._v(" "),t.showImagesModal?n("images-modal",{on:{insertImage:t.insertImage,closeImagesModal:function(e){t.showImagesModal=!1}}}):t._e(),t._v(" "),t.showDocumentsModal?n("documents-modal",{on:{insertDocument:t.insertDocument,closeDocumentsModal:function(e){t.showDocumentsModal=!1}}}):t._e(),t._v(" "),t.showCreateLinkModal?n("create-link-modal",{on:{insertLink:t.insertLink}}):t._e()],1)},[],!1,null,"5bfb789c",null);e.default=v.exports},263:function(t,e,n){"use strict";var o=n(32);n.n(o).a},264:function(t,e,n){(t.exports=n(7)(!1)).push([t.i,".image[data-v-0467b858]:hover {\n  cursor: pointer;\n  border: 2px solid #2C5CAD;\n}\n#preview[data-v-0467b858] {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin-top: 1em;\n}\n#preview img[data-v-0467b858] {\n  max-width: 50%;\n  max-height: 200px;\n}\n.unselectable[data-v-0467b858] {\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n}",""])},280:function(t,e,n){"use strict";var o=n(41);n.n(o).a},281:function(t,e,n){(t.exports=n(7)(!1)).push([t.i,"#textBox[data-v-5bfb789c] {\n  width: 100%;\n  height: 250px;\n  border: 6px double #E1B124;\n  padding: 12px;\n  overflow: scroll;\n}\n#textBox #sourceText[data-v-5bfb789c] {\n  padding: 0;\n  margin: 0;\n  min-width: 498px;\n  min-height: 200px;\n}\n[data-v-5bfb789c] #textBox img:hover {\n  cursor: pointer;\n  border: 2px solid #2C5CAD;\n}\n#editMode label[data-v-5bfb789c] {\n  cursor: pointer;\n}\n.intLink[data-v-5bfb789c] {\n  cursor: pointer;\n}\nimg.intLink[data-v-5bfb789c] {\n  border: 1px solid #000;\n}\n.resizable[data-v-5bfb789c] {\n  display: inline-block;\n  background: red;\n  resize: both;\n  overflow: hidden;\n  line-height: 0;\n}\n.resizable img[data-v-5bfb789c] {\n  width: 100%;\n  height: 100%;\n}\n.button2[data-v-5bfb789c]:hover {\n  cursor: pointer;\n  color: orange;\n}\n.disabled[data-v-5bfb789c]:hover {\n  cursor: not-allowed;\n  color: #000;\n}\npre[data-v-5bfb789c] {\n  overflow-x: auto;\n  white-space: pre-wrap;\n  white-space: -moz-pre-wrap;\n  white-space: -pre-wrap;\n  white-space: -o-pre-wrap;\n  word-wrap: break-word;\n}\n\n/*.cke_image_resizer {\n    display: none;\n    position: absolute;\n    width: 10px;\n    height: 10px;\n    bottom: -5px;\n    right: -5px;\n    background: #000;\n    outline: 1px solid #fff;\n    line-height: 0;\n    cursor: se-resize;\n}*/",""])},32:function(t,e,n){var o=n(264);"string"==typeof o&&(o=[[t.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(8)(o,a);o.locals&&(t.exports=o.locals)},41:function(t,e,n){var o=n(281);"string"==typeof o&&(o=[[t.i,o,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(8)(o,a);o.locals&&(t.exports=o.locals)},58:function(t,e,n){"use strict";var o=n(0),a=n.n(o);n(5),n(4),n(10);function r(t,e,n,o,a,r,i){try{var s=t[r](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(o,a)}function i(t){return function(){var e=this,n=arguments;return new Promise(function(o,a){var i=t.apply(e,n);function s(t){r(i,o,a,s,c,"next",t)}function c(t){r(i,o,a,s,c,"throw",t)}s(void 0)})}}var s={created:function(){var t=i(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),mounted:function(){var t=i(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:console.log("CreateLinkModal mounted!");case 1:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),data:function(){return{url:"http://google.ch"}},computed:{loading:function(){return this.$store.getters["loading/loading"]}},methods:{insertLink:function(){this.$emit("insertLink",this.url),this.$bvModal.hide("createLinkModal")},closeModal:function(){console.log("closeModal"),this.$emit("closeDocumentsModal",!1),this.$bvModal.hide("documentsModal")}}},c=(n(263),n(2)),l=Object(c.a)(s,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-modal",{attrs:{size:"md",id:"createLinkModal",title:"Créer un lien","ok-disabled":"","no-close-on-esc":"","no-close-on-backdrop":""},on:{close:t.closeModal},scopedSlots:t._u([{key:"modal-title",fn:function(){return[n("span",{staticClass:"unselectable"},[t._v("Lien")])]},proxy:!0},{key:"modal-footer",fn:function(){return[n("b-row",[n("div",{staticClass:"w-100"},[n("b-button",{staticClass:"float-right",attrs:{variant:"primary",size:"md"},on:{click:t.insertLink}},[t._v("\n                Insérer\n            ")]),t._v(" "),n("b-button",{staticClass:"float-right ml-2",attrs:{variant:"dark",size:"md"},on:{click:t.closeModal}},[t._v("\n                Fermer\n            ")])],1)])]},proxy:!0}])},[t._v(" "),n("b-form-group",{attrs:{label:"URL:","label-for":"url"}},[n("b-form-input",{attrs:{id:"url",name:"url",placeholder:"Url du lien"},model:{value:t.url,callback:function(e){t.url=e},expression:"url"}})],1)],1)},[],!1,null,"0467b858",null);e.a=l.exports}}]);